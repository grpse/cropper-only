!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("cropper-only",["exports","@angular/common","@angular/core","@angular/platform-browser"],e):e(t["cropper-only"]={},t.ng.common,t.ng.core,t.ng.platformBrowser)}(this,function(t,e,r,i){"use strict";var s=function(){return(s=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=(p.prototype.ngOnInit=function(){this.maxSize={width:this.elementContainer.offsetWidth,height:this.elementContainer.offsetHeight}},p.prototype.ngOnChanges=function(t){t.cropper&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.checkCropperPosition(!1),this.doAutoCrop(),this.cd.markForCheck()),t.aspectRatio&&this.imageVisible&&this.resetCropperPosition()},Object.defineProperty(p.prototype,"videoCropperSlice",{set:function(t){var e=this.elementContainer.videoWidth/this.elementContainer.offsetWidth;this.cropper.x1=t.x1/e,this.cropper.y1=t.y1/e,this.cropper.x2=t.x2/e,this.cropper.y2=t.y2/e,console.log("this.cropper",this.cropper)},enumerable:!0,configurable:!0}),p.prototype.setCropperInitializationValues=function(){this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4},p.prototype.checkImageMaxSizeRecursively=function(){var t=this;this.elementContainer&&0<this.elementContainer.offsetWidth?(this.setMaxSize(),this.setCropperScaledMinSize(),this.resetCropperPosition(),this.cropperReady.emit(),this.cd.markForCheck()):setTimeout(function(){t.checkImageMaxSizeRecursively()},50)},p.prototype.onResize=function(){this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize()},p.prototype.resizeCropperPosition=function(){var t=this.elementContainer;this.maxSize.width===t.offsetWidth&&this.maxSize.height===t.offsetHeight||(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)},p.prototype.resetCropperPosition=function(){var t=this.elementContainer;if(this.maintainAspectRatio)if(t.offsetWidth/this.aspectRatio<t.offsetHeight){this.cropper.x1=0,this.cropper.x2=t.offsetWidth;var e=t.offsetWidth/this.aspectRatio;this.cropper.y1=(t.offsetHeight-e)/2,this.cropper.y2=this.cropper.y1+e}else{this.cropper.y1=0,this.cropper.y2=t.offsetHeight;var i=t.offsetHeight*this.aspectRatio;this.cropper.x1=(t.offsetWidth-i)/2,this.cropper.x2=this.cropper.x1+i}else this.cropper.x1=0,this.cropper.x2=t.offsetWidth,this.cropper.y1=0,this.cropper.y2=t.offsetHeight;this.doAutoCrop(),this.imageVisible=!0},p.prototype.startMove=function(t,e,i){void 0===i&&(i=null),t.preventDefault(),this.moveStart=s({active:!0,type:e,position:i,clientX:this.getClientX(t),clientY:this.getClientY(t)},this.cropper)},p.prototype.moveImg=function(t){this.moveStart.active&&(t.stopPropagation(),t.preventDefault(),"move"===this.moveStart.type?(this.move(t),this.checkCropperPosition(!0)):"resize"===this.moveStart.type&&(this.resize(t),this.checkCropperPosition(!1)),this.cd.detectChanges())},p.prototype.setMaxSize=function(){var t=this.elementContainer;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")},p.prototype.setCropperScaledMinSize=function(){0<this.cropperMinWidth?(this.cropperScaledMinWidth=Math.max(20,this.cropperMinWidth/this.elementContainer.clientWidth*this.maxSize.width),this.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.cropperScaledMinWidth/this.aspectRatio):20):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)},p.prototype.checkCropperPosition=function(t){void 0===t&&(t=!1),this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)},p.prototype.moveStop=function(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())},p.prototype.move=function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;this.cropper.x1=this.moveStart.x1+e,this.cropper.y1=this.moveStart.y1+i,this.cropper.x2=this.moveStart.x2+e,this.cropper.y2=this.moveStart.y2+i},p.prototype.resize=function(t){var e=this.getClientX(t)-this.moveStart.clientX,i=this.getClientY(t)-this.moveStart.clientY;switch(this.moveStart.position){case"left":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth);break;case"topleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"top":this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"topright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y1=Math.min(this.moveStart.y1+i,this.cropper.y2-this.cropperScaledMinHeight);break;case"right":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth);break;case"bottomright":this.cropper.x2=Math.max(this.moveStart.x2+e,this.cropper.x1+this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottom":this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight);break;case"bottomleft":this.cropper.x1=Math.min(this.moveStart.x1+e,this.cropper.x2-this.cropperScaledMinWidth),this.cropper.y2=Math.max(this.moveStart.y2+i,this.cropper.y1+this.cropperScaledMinHeight)}this.maintainAspectRatio&&this.checkAspectRatio()},p.prototype.checkAspectRatio=function(){var t=0,e=0;switch(this.moveStart.position){case"top":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(0<t||0<e)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"bottom":this.cropper.x2=this.cropper.x1+(this.cropper.y2-this.cropper.y1)*this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(0<t||0<e)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topleft":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(0-this.cropper.y1,0),(0<t||0<e)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"topright":this.cropper.y1=this.cropper.y2-(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(0-this.cropper.y1,0),(0<t||0<e)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y1+=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"right":case"bottomright":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(this.cropper.x2-this.maxSize.width,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(0<t||0<e)&&(this.cropper.x2-=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio);break;case"left":case"bottomleft":this.cropper.y2=this.cropper.y1+(this.cropper.x2-this.cropper.x1)/this.aspectRatio,t=Math.max(0-this.cropper.x1,0),e=Math.max(this.cropper.y2-this.maxSize.height,0),(0<t||0<e)&&(this.cropper.x1+=e*this.aspectRatio>t?e*this.aspectRatio:t,this.cropper.y2-=e*this.aspectRatio>t?e:t/this.aspectRatio)}},p.prototype.doAutoCrop=function(){this.autoCrop&&this.crop()},p.prototype.crop=function(){if(this.elementContainer){var t=this.getImagePosition(),e=t.x2-t.x1,i=t.y2-t.y1,r={width:e,height:i,imagePosition:t,cropperPosition:s({},this.cropper)},o=this.getResizeRatio(e);1!==o&&(r.width=Math.floor(e*o),r.height=Math.floor(i*o)),this.imageCropped.emit(r)}return null},p.prototype.getImagePosition=function(){var t=this.elementContainer,e=this.elementContainer.videoWidth/t.offsetWidth;return{x1:Math.round(this.cropper.x1*e),y1:Math.round(this.cropper.y1*e),x2:Math.min(Math.round(this.cropper.x2*e),this.elementContainer.videoWidth),y2:Math.min(Math.round(this.cropper.y2*e),this.elementContainer.videoHeight)}},p.prototype.getResizeRatio=function(t){return 0<this.resizeToWidth&&(!this.onlyScaleDown||t>this.resizeToWidth)?this.resizeToWidth/t:1},p.prototype.getClientX=function(t){return t.clientX||t.touches&&t.touches[0]&&t.touches[0].clientX},p.prototype.getClientY=function(t){return t.clientY||t.touches&&t.touches[0]&&t.touches[0].clientY},p.decorators=[{type:r.Component,args:[{selector:"cropper",template:'<div>\n        \x3c!-- [style.margin-left]="alignImage === \'center\' ? marginLeft : null" --\x3e\n        \n  <div class="cropper"\n       [class.rounded]="roundCropper"\n       [style.top.px]="cropper.y1"\n       [style.left.px]="cropper.x1"\n       [style.width.px]="cropper.x2 - cropper.x1"\n       [style.height.px]="cropper.y2 - cropper.y1"\n       [style.visibility]="\'visible\'"\n  >\n      <div\n              (mousedown)="startMove($event, \'move\')"\n              (touchstart)="startMove($event, \'move\')"\n              class="move"\n      >&nbsp;</div>\n      <span\n              class="resize topleft"\n              (mousedown)="startMove($event, \'resize\', \'topleft\')"\n              (touchstart)="startMove($event, \'resize\', \'topleft\')"\n      ><span class="square"></span></span>\n      <span\n              class="resize top"\n      ><span class="square"></span></span>\n      <span\n              class="resize topright"\n              (mousedown)="startMove($event, \'resize\', \'topright\')"\n              (touchstart)="startMove($event, \'resize\', \'topright\')"\n      ><span class="square"></span></span>\n      <span\n              class="resize right"\n      ><span class="square"></span></span>\n      <span\n              class="resize bottomright"\n              (mousedown)="startMove($event, \'resize\', \'bottomright\')"\n              (touchstart)="startMove($event, \'resize\', \'bottomright\')"\n      ><span class="square"></span></span>\n      <span\n              class="resize bottom"\n      ><span class="square"></span></span>\n      <span\n              class="resize bottomleft"\n              (mousedown)="startMove($event, \'resize\', \'bottomleft\')"\n              (touchstart)="startMove($event, \'resize\', \'bottomleft\')"\n      ><span class="square"></span></span>\n      <span\n              class="resize left"\n      ><span class="square"></span></span>\n      <span\n              class="resize-bar top"\n              (mousedown)="startMove($event, \'resize\', \'top\')"\n              (touchstart)="startMove($event, \'resize\', \'top\')"\n      ></span>\n      <span\n              class="resize-bar right"\n              (mousedown)="startMove($event, \'resize\', \'right\')"\n              (touchstart)="startMove($event, \'resize\', \'right\')"\n      ></span>\n      <span\n              class="resize-bar bottom"\n              (mousedown)="startMove($event, \'resize\', \'bottom\')"\n              (touchstart)="startMove($event, \'resize\', \'bottom\')"\n      ></span>\n      <span\n              class="resize-bar left"\n              (mousedown)="startMove($event, \'resize\', \'left\')"\n              (touchstart)="startMove($event, \'resize\', \'left\')"\n      ></span>\n  </div>\n</div>\n',changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host>div{position:relative;width:100%}:host>div img.source-image{max-width:100%;max-height:100%}:host .cropper{position:absolute;display:flex;color:#53535c;background:0 0;touch-action:none;outline:rgba(255,255,255,.3) solid 100vw}:host .cropper:after{position:absolute;content:'';top:0;bottom:0;left:0;right:0;pointer-events:none;border:1px dashed;opacity:.75;color:inherit;z-index:1}:host .cropper .move{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}:host .cropper .resize{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}:host .cropper .resize .square{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}:host .cropper .resize.topleft{top:-12px;left:-12px;cursor:nwse-resize}:host .cropper .resize.top{top:-12px;left:calc(50% - 12px);cursor:ns-resize}:host .cropper .resize.topright{top:-12px;right:-12px;cursor:nesw-resize}:host .cropper .resize.right{top:calc(50% - 12px);right:-12px;cursor:ew-resize}:host .cropper .resize.bottomright{bottom:-12px;right:-12px;cursor:nwse-resize}:host .cropper .resize.bottom{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}:host .cropper .resize.bottomleft{bottom:-12px;left:-12px;cursor:nesw-resize}:host .cropper .resize.left{top:calc(50% - 12px);left:-12px;cursor:ew-resize}:host .cropper .resize-bar{position:absolute;z-index:1}:host .cropper .resize-bar.top{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}:host .cropper .resize-bar.right{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}:host .cropper .resize-bar.bottom{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}:host .cropper .resize-bar.left{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}:host .cropper.rounded{outline-color:transparent}:host .cropper.rounded:after{border-radius:100%;box-shadow:0 0 0 100vw rgba(255,255,255,.3)}@media (orientation:portrait){:host .cropper{outline-width:100vh}:host .cropper.rounded:after{box-shadow:0 0 0 100vh rgba(255,255,255,.3)}}:host .cropper.rounded .move{border-radius:100%}"]}]}],p.ctorParameters=function(){return[{type:i.DomSanitizer},{type:r.ChangeDetectorRef},{type:r.NgZone}]},p.propDecorators={elementContainer:[{type:r.Input}],maintainAspectRatio:[{type:r.Input}],aspectRatio:[{type:r.Input}],resizeToWidth:[{type:r.Input}],cropperMinWidth:[{type:r.Input}],roundCropper:[{type:r.Input}],onlyScaleDown:[{type:r.Input}],autoCrop:[{type:r.Input}],cropper:[{type:r.Input}],imageCropped:[{type:r.Output}],cropperReady:[{type:r.Output}],videoCropperSlice:[{type:r.Input}],onResize:[{type:r.HostListener,args:["window:resize"]}],moveImg:[{type:r.HostListener,args:["document:mousemove",["$event"]]},{type:r.HostListener,args:["document:touchmove",["$event"]]}],moveStop:[{type:r.HostListener,args:["document:mouseup"]},{type:r.HostListener,args:["document:touchend"]}]},p);function p(t,e,i){this.sanitizer=t,this.cd=e,this.zone=i,this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.marginLeft="0px",this.imageVisible=!1,this.maintainAspectRatio=!0,this.aspectRatio=1,this.resizeToWidth=0,this.cropperMinWidth=0,this.roundCropper=!1,this.onlyScaleDown=!1,this.autoCrop=!0,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.imageCropped=new r.EventEmitter,this.cropperReady=new r.EventEmitter,this.setCropperInitializationValues()}var h=(a.decorators=[{type:r.NgModule,args:[{imports:[e.CommonModule],declarations:[o],exports:[o]}]}],a);function a(){}t.CropperModule=h,t.CropperComponent=o,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=cropper-only.umd.min.js.map